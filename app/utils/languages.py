"""
Language configuration and translation utilities for multilingual chatbot.
Supports English, Hindi, Telugu, Tamil, Marathi, Kannada, and more.
"""

from typing import Dict, List, Optional
import re

# Supported languages configuration
SUPPORTED_LANGUAGES = {
    "en": {"name": "English", "native": "English", "flag": "ðŸ‡¬ðŸ‡§"},
    "hi": {"name": "Hindi", "native": "à¤¹à¤¿à¤¨à¥à¤¦à¥€", "flag": "ðŸ‡®ðŸ‡³"},
    "te": {"name": "Telugu", "native": "à°¤à±†à°²à±à°—à±", "flag": "ðŸ‡®ðŸ‡³"},
    "ta": {"name": "Tamil", "native": "à®¤à®®à®¿à®´à¯", "flag": "ðŸ‡®ðŸ‡³"},
    "mr": {"name": "Marathi", "native": "à¤®à¤°à¤¾à¤ à¥€", "flag": "ðŸ‡®ðŸ‡³"},
    "kn": {"name": "Kannada", "native": "à²•à²¨à³à²¨à²¡", "flag": "ðŸ‡®ðŸ‡³"},
    "bn": {"name": "Bengali", "native": "à¦¬à¦¾à¦‚à¦²à¦¾", "flag": "ðŸ‡®ðŸ‡³"},
    "gu": {"name": "Gujarati", "native": "àª—à«àªœàª°àª¾àª¤à«€", "flag": "ðŸ‡®ðŸ‡³"},
}

DEFAULT_LANGUAGE = "en"

# UI Translations for all supported languages
TRANSLATIONS = {
    # Welcome messages
    "welcome_title": {
        "en": "Hello! ðŸ‘‹ Welcome to the **VNRVJIET** assistant.",
        "hi": "à¤¨à¤®à¤¸à¥à¤¤à¥‡! ðŸ‘‹ **VNRVJIET** à¤¸à¤¹à¤¾à¤¯à¤• à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆà¥¤",
        "te": "à°¨à°®à°¸à±à°•à°¾à°°à°‚! ðŸ‘‹ **VNRVJIET** à°¸à°¹à°¾à°¯à°•à±à°¨à°¿à°•à°¿ à°¸à±à°µà°¾à°—à°¤à°‚à¥¤",
        "ta": "à®µà®£à®•à¯à®•à®®à¯! ðŸ‘‹ **VNRVJIET** à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯à®•à¯à®•à¯ à®µà®°à®µà¯‡à®±à¯à®•à®¿à®±à¯‹à®®à¯.",
        "mr": "à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°! ðŸ‘‹ **VNRVJIET** à¤¸à¤¹à¤¾à¤¯à¥à¤¯à¤•à¤¾à¤‚à¤®à¤§à¥à¤¯à¥‡ à¤†à¤ªà¤²à¥‡ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤†à¤¹à¥‡.",
        "kn": "à²¨à²®à²¸à³à²•à²¾à²°! ðŸ‘‹ **VNRVJIET** à²¸à²¹à²¾à²¯à²•à²¨à²¿à²—à³† à²¸à³à²µà²¾à²—à²¤.",
        "bn": "à¦¨à¦®à¦¸à§à¦•à¦¾à¦°! ðŸ‘‹ **VNRVJIET** à¦¸à¦¹à¦¾à¦¯à¦¼à¦•à§‡ à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®à¥¤",
        "gu": "àª¨àª®àª¸à«àª¤à«‡! ðŸ‘‹ **VNRVJIET** àª¸àª¹àª¾àª¯àª•àª®àª¾àª‚ àª†àªªàª¨à«àª‚ àª¸à«àªµàª¾àª—àª¤ àª›à«‡.",
    },
    "welcome_select_topic": {
        "en": "I can help you with the following topics. Please select one:",
        "hi": "à¤®à¥ˆà¤‚ à¤¨à¤¿à¤®à¥à¤¨à¤²à¤¿à¤–à¤¿à¤¤ à¤µà¤¿à¤·à¤¯à¥‹à¤‚ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¥€ à¤®à¤¦à¤¦ à¤•à¤° à¤¸à¤•à¤¤à¤¾/à¤¸à¤•à¤¤à¥€ à¤¹à¥‚à¤‚à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤à¤• à¤šà¥à¤¨à¥‡à¤‚:",
        "te": "à°¨à±‡à°¨à± à°ˆ à°•à±à°°à°¿à°‚à°¦à°¿ à°…à°‚à°¶à°¾à°²à°²à±‹ à°®à±€à°•à± à°¸à°¹à°¾à°¯à°‚ à°šà±‡à°¯à°—à°²à°¨à±. à°¦à°¯à°šà±‡à°¸à°¿ à°’à°•à°¦à°¾à°¨à±à°¨à°¿ à°Žà°‚à°šà±à°•à±‹à°‚à°¡à°¿:",
        "ta": "à®¨à®¾à®©à¯ à®ªà®¿à®©à¯à®µà®°à¯à®®à¯ à®¤à®²à¯ˆà®ªà¯à®ªà¯à®•à®³à®¿à®²à¯ à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®‰à®¤à®µ à®®à¯à®Ÿà®¿à®¯à¯à®®à¯. à®¤à®¯à®µà¯à®šà¯†à®¯à¯à®¤à¯ à®’à®©à¯à®±à¯ˆà®¤à¯ à®¤à¯‡à®°à¯à®¨à¯à®¤à¯†à®Ÿà¯à®•à¯à®•à®µà¯à®®à¯:",
        "mr": "à¤®à¥€ à¤–à¤¾à¤²à¥€à¤² à¤µà¤¿à¤·à¤¯à¤¾à¤‚à¤®à¤§à¥à¤¯à¥‡ à¤¤à¥à¤®à¤šà¥€ à¤®à¤¦à¤¤ à¤•à¤°à¥‚ à¤¶à¤•à¤¤à¥‹. à¤•à¥ƒà¤ªà¤¯à¤¾ à¤à¤• à¤¨à¤¿à¤µà¤¡à¤¾:",
        "kn": "à²¨à²¾à²¨à³ à²ˆ à²•à³†à²³à²—à²¿à²¨ à²µà²¿à²·à²¯à²—à²³à²²à³à²²à²¿ à²¨à²¿à²®à²—à³† à²¸à²¹à²¾à²¯ à²®à²¾à²¡à²¬à²¹à³à²¦à³. à²¦à²¯à²µà²¿à²Ÿà³à²Ÿà³ à²’à²‚à²¦à²¨à³à²¨à³ à²†à²¯à³à²•à³†à²®à²¾à²¡à²¿:",
        "bn": "à¦†à¦®à¦¿ à¦¨à¦¿à¦®à§à¦¨à¦²à¦¿à¦–à¦¿à¦¤ à¦¬à¦¿à¦·à¦¯à¦¼à¦—à§à¦²à¦¿à¦¤à§‡ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦¸à¦¾à¦¹à¦¾à¦¯à§à¦¯ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤ à¦¦à¦¯à¦¼à¦¾ à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨:",
        "gu": "àª¹à«àª‚ àª¨à«€àªšà«‡àª¨àª¾ àªµàª¿àª·àª¯à«‹àª®àª¾àª‚ àª¤àª®àª¾àª°à«€ àª®àª¦àª¦ àª•àª°à«€ àª¶àª•à«àª‚ àª›à«àª‚. àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àªàª• àªªàª¸àª‚àª¦ àª•àª°à«‹:",
    },
    "language_selection_prompt": {
        "en": "Please select your preferred language:",
        "hi": "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥€ à¤ªà¤¸à¤‚à¤¦à¥€à¤¦à¤¾ à¤­à¤¾à¤·à¤¾ à¤šà¥à¤¨à¥‡à¤‚:",
        "te": "à°¦à°¯à°šà±‡à°¸à°¿ à°®à±€ à°‡à°·à±à°Ÿ à°­à°¾à°·à°¨à± à°Žà°‚à°šà±à°•à±‹à°‚à°¡à°¿:",
        "ta": "à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®µà®¿à®°à¯à®ªà¯à®ªà®®à®¾à®© à®®à¯Šà®´à®¿à®¯à¯ˆà®¤à¯ à®¤à¯‡à®°à¯à®¨à¯à®¤à¯†à®Ÿà¯à®•à¯à®•à®µà¯à®®à¯:",
        "mr": "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¤à¥à¤®à¤šà¥€ à¤ªà¤¸à¤‚à¤¤à¥€à¤šà¥€ à¤­à¤¾à¤·à¤¾ à¤¨à¤¿à¤µà¤¡à¤¾:",
        "kn": "à²¦à²¯à²µà²¿à²Ÿà³à²Ÿà³ à²¨à²¿à²®à³à²® à²†à²¦à³à²¯à²¤à³†à²¯ à²­à²¾à²·à³†à²¯à²¨à³à²¨à³ à²†à²¯à³à²•à³†à²®à²¾à²¡à²¿:",
        "bn": "à¦¦à¦¯à¦¼à¦¾ à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦›à¦¨à§à¦¦à§‡à¦° à¦­à¦¾à¦·à¦¾ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨:",
        "gu": "àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª¤àª®àª¾àª°à«€ àªªàª¸àª‚àª¦àª—à«€àª¨à«€ àª­àª¾àª·àª¾ àªªàª¸àª‚àª¦ àª•àª°à«‹:",
    },
    "language_changed": {
        "en": "Language changed to English. How can I help you?",
        "hi": "à¤­à¤¾à¤·à¤¾ à¤¹à¤¿à¤¨à¥à¤¦à¥€ à¤®à¥‡à¤‚ à¤¬à¤¦à¤² à¤—à¤ˆà¥¤ à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤•à¥ˆà¤¸à¥‡ à¤®à¤¦à¤¦ à¤•à¤° à¤¸à¤•à¤¤à¤¾/à¤¸à¤•à¤¤à¥€ à¤¹à¥‚à¤‚?",
        "te": "à°­à°¾à°· à°¤à±†à°²à±à°—à±à°•à± à°®à°¾à°°à±à°šà°¬à°¡à°¿à°‚à°¦à°¿. à°¨à±‡à°¨à± à°®à±€à°•à± à°Žà°²à°¾ à°¸à°¹à°¾à°¯à°ªà°¡à°—à°²à°¨à±?",
        "ta": "à®®à¯Šà®´à®¿ à®¤à®®à®¿à®´à¯à®•à¯à®•à¯ à®®à®¾à®±à¯à®±à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯. à®¨à®¾à®©à¯ à®Žà®ªà¯à®ªà®Ÿà®¿ à®‰à®¤à®µ à®®à¯à®Ÿà®¿à®¯à¯à®®à¯?",
        "mr": "à¤­à¤¾à¤·à¤¾ à¤®à¤°à¤¾à¤ à¥€à¤®à¤§à¥à¤¯à¥‡ à¤¬à¤¦à¤²à¤²à¥€. à¤®à¥€ à¤¤à¥à¤®à¤šà¥€ à¤•à¤¶à¥€ à¤®à¤¦à¤¤ à¤•à¤°à¥‚ à¤¶à¤•à¤¤à¥‹?",
        "kn": "à²­à²¾à²·à³†à²¯à²¨à³à²¨à³ à²•à²¨à³à²¨à²¡à²•à³à²•à³† à²¬à²¦à²²à²¿à²¸à²²à²¾à²—à²¿à²¦à³†. à²¨à²¾à²¨à³ à²¨à²¿à²®à²—à³† à²¹à³‡à²—à³† à²¸à²¹à²¾à²¯ à²®à²¾à²¡à²¬à²¹à³à²¦à³?",
        "bn": "à¦­à¦¾à¦·à¦¾ à¦¬à¦¾à¦‚à¦²à¦¾à¦¯à¦¼ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¿à¦¤ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦†à¦®à¦¿ à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦¸à¦¾à¦¹à¦¾à¦¯à§à¦¯ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿?",
        "gu": "àª­àª¾àª·àª¾ àª—à«àªœàª°àª¾àª¤à«€àª®àª¾àª‚ àª¬àª¦àª²àª¾àªˆ àª›à«‡. àª¹à«àª‚ àª¤àª®àª¾àª°à«€ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àª®àª¦àª¦ àª•àª°à«€ àª¶àª•à«àª‚?",
    },
    # Category names
    "category_admission": {
        "en": "Admission Process & Eligibility",
        "hi": "à¤ªà¥à¤°à¤µà¥‡à¤¶ à¤ªà¥à¤°à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤”à¤° à¤ªà¤¾à¤¤à¥à¤°à¤¤à¤¾",
        "te": "à°ªà±à°°à°µà±‡à°¶ à°ªà±à°°à°•à±à°°à°¿à°¯ & à°…à°°à±à°¹à°¤",
        "ta": "à®šà¯‡à®°à¯à®•à¯à®•à¯ˆ à®šà¯†à®¯à®²à¯à®®à¯à®±à¯ˆ & à®¤à®•à¯à®¤à®¿",
        "mr": "à¤ªà¥à¤°à¤µà¥‡à¤¶ à¤ªà¥à¤°à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤†à¤£à¤¿ à¤ªà¤¾à¤¤à¥à¤°à¤¤à¤¾",
        "kn": "à²ªà³à²°à²µà³‡à²¶ à²ªà³à²°à²•à³à²°à²¿à²¯à³† à²®à²¤à³à²¤à³ à²…à²°à³à²¹à²¤à³†",
        "bn": "à¦­à¦°à§à¦¤à¦¿ à¦ªà§à¦°à¦•à§à¦°à¦¿à¦¯à¦¼à¦¾ à¦à¦¬à¦‚ à¦¯à§‹à¦—à§à¦¯à¦¤à¦¾",
        "gu": "àªªà«àª°àªµà«‡àª¶ àªªà«àª°àª•à«àª°àª¿àª¯àª¾ àª…àª¨à«‡ àª²àª¾àª¯àª•àª¾àª¤",
    },
    "category_cutoff": {
        "en": "Branch-wise Cutoff Ranks",
        "hi": "à¤¶à¤¾à¤–à¤¾-à¤µà¤¾à¤° à¤•à¤Ÿà¤‘à¤« à¤°à¥ˆà¤‚à¤•",
        "te": "à°¬à±à°°à°¾à°‚à°šà±-à°µà°¾à°°à±€ à°•à°Ÿà°¾à°«à± à°°à±à°¯à°¾à°‚à°•à±â€Œà°²à±",
        "ta": "à®•à®¿à®³à¯ˆ à®µà®¾à®°à®¿à®¯à®¾à®© à®•à®Ÿà¯à®†à®ƒà®ªà¯ à®¤à®°à®µà®°à®¿à®šà¯ˆ",
        "mr": "à¤¶à¤¾à¤–à¤¾-à¤¨à¤¿à¤¹à¤¾à¤¯ à¤•à¤Ÿà¤‘à¤« à¤°à¥…à¤‚à¤•",
        "kn": "à²¶à²¾à²–à³†à²¯ à²ªà³à²°à²•à²¾à²° à²•à²Ÿà³â€Œà²†à²«à³ à²¶à³à²°à³‡à²£à²¿à²—à²³à³",
        "bn": "à¦¶à¦¾à¦–à¦¾-à¦­à¦¿à¦¤à§à¦¤à¦¿à¦• à¦•à¦¾à¦Ÿ à¦…à¦« à¦°â€à§à¦¯à¦¾à¦™à§à¦•",
        "gu": "àª¶àª¾àª–àª¾ àª®à«àªœàª¬ àª•àªŸàª“àª« àª°à«‡àª¨à«àª•",
    },
    "category_documents": {
        "en": "Required Documents",
        "hi": "à¤†à¤µà¤¶à¥à¤¯à¤• à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œ",
        "te": "à°…à°µà°¸à°°à°®à±ˆà°¨ à°ªà°¤à±à°°à°¾à°²à±",
        "ta": "à®¤à¯‡à®µà¯ˆà®¯à®¾à®© à®†à®µà®£à®™à¯à®•à®³à¯",
        "mr": "à¤†à¤µà¤¶à¥à¤¯à¤• à¤•à¤¾à¤—à¤¦à¤ªà¤¤à¥à¤°à¥‡",
        "kn": "à²…à²—à²¤à³à²¯ à²¦à²¾à²–à²²à³†à²—à²³à³",
        "bn": "à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨à§€à¦¯à¦¼ à¦¨à¦¥à¦¿à¦ªà¦¤à§à¦°",
        "gu": "àªœàª°à«‚àª°à«€ àª¦àª¸à«àª¤àª¾àªµà«‡àªœà«‹",
    },
    "category_fees": {
        "en": "Fee Structure & Scholarships",
        "hi": "à¤¶à¥à¤²à¥à¤• à¤¸à¤‚à¤°à¤šà¤¨à¤¾ à¤”à¤° à¤›à¤¾à¤¤à¥à¤°à¤µà¥ƒà¤¤à¥à¤¤à¤¿",
        "te": "à°«à±€à°œà± à°¨à°¿à°°à±à°®à°¾à°£à°‚ & à°¸à±à°•à°¾à°²à°°à±â€Œà°·à°¿à°ªà±â€Œà°²à±",
        "ta": "à®•à®Ÿà¯à®Ÿà®£à®®à¯ & à®‰à®¤à®µà®¿à®¤à¯à®¤à¯Šà®•à¯ˆ",
        "mr": "à¤«à¥€ à¤°à¤šà¤¨à¤¾ à¤†à¤£à¤¿ à¤¶à¤¿à¤·à¥à¤¯à¤µà¥ƒà¤¤à¥à¤¤à¥€",
        "kn": "à²¶à³à²²à³à²• à²°à²šà²¨à³† à²®à²¤à³à²¤à³ à²µà²¿à²¦à³à²¯à²¾à²°à³à²¥à²¿à²µà³‡à²¤à²¨",
        "bn": "à¦«à¦¿ à¦•à¦¾à¦ à¦¾à¦®à§‹ à¦à¦¬à¦‚ à¦¬à§ƒà¦¤à§à¦¤à¦¿",
        "gu": "àª«à«€ àª®àª¾àª³àª–à«àª‚ àª…àª¨à«‡ àª¶àª¿àª·à«àª¯àªµà«ƒàª¤à«àª¤àª¿",
    },
    "category_others": {
        "en": "Others",
        "hi": "à¤…à¤¨à¥à¤¯",
        "te": "à°‡à°¤à°°à°®à±à°²à±",
        "ta": "à®®à®±à¯à®±à®µà¯ˆ",
        "mr": "à¤‡à¤¤à¤°",
        "kn": "à²‡à²¤à²°à³†",
        "bn": "à¦…à¦¨à§à¦¯à¦¾à¦¨à§à¦¯",
        "gu": "àª…àª¨à«àª¯",
    },
    # Input placeholder
    "input_placeholder": {
        "en": "Ask about admissions...",
        "hi": "à¤ªà¥à¤°à¤µà¥‡à¤¶ à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤ªà¥‚à¤›à¥‡à¤‚...",
        "te": "à°ªà±à°°à°µà±‡à°¶à°¾à°² à°—à±à°°à°¿à°‚à°šà°¿ à°…à°¡à°—à°‚à°¡à°¿...",
        "ta": "à®šà¯‡à®°à¯à®•à¯à®•à¯ˆ à®ªà®±à¯à®±à®¿ à®•à¯‡à®³à¯à®™à¯à®•à®³à¯...",
        "mr": "à¤ªà¥à¤°à¤µà¥‡à¤¶à¤¾à¤¬à¤¦à¥à¤¦à¤² à¤µà¤¿à¤šà¤¾à¤°à¤¾...",
        "kn": "à²ªà³à²°à²µà³‡à²¶à²¦ à²¬à²—à³à²—à³† à²•à³‡à²³à²¿...",
        "bn": "à¦­à¦°à§à¦¤à¦¿ à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡ à¦œà¦¿à¦œà§à¦žà¦¾à¦¸à¦¾ à¦•à¦°à§à¦¨...",
        "gu": "àªªà«àª°àªµà«‡àª¶ àªµàª¿àª¶à«‡ àªªà«‚àª›à«‹...",
    },
    # Error messages
    "error_connection": {
        "en": "Sorry, I'm having trouble connecting right now. Please try again in a moment.",
        "hi": "à¤•à¥à¤·à¤®à¤¾ à¤•à¤°à¥‡à¤‚, à¤®à¥à¤à¥‡ à¤…à¤­à¥€ à¤•à¤¨à¥‡à¤•à¥à¤Ÿ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤¸à¤®à¤¸à¥à¤¯à¤¾ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤•à¥à¤› à¤¦à¥‡à¤° à¤¬à¤¾à¤¦ à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤",
        "te": "à°•à±à°·à°®à°¿à°‚à°šà°‚à°¡à°¿, à°¨à°¾à°•à± à°‡à°ªà±à°ªà±à°¡à± à°•à°¨à±†à°•à±à°Ÿà± à°šà±‡à°¯à°¡à°‚à°²à±‹ à°¸à°®à°¸à±à°¯ à°‰à°‚à°¦à°¿. à°¦à°¯à°šà±‡à°¸à°¿ à°•à±Šà°¦à±à°¦à°¿à°¸à±‡à°ªà°Ÿà°¿ à°¤à°°à±à°µà°¾à°¤ à°®à°³à±à°²à±€ à°ªà±à°°à°¯à°¤à±à°¨à°¿à°‚à°šà°‚à°¡à°¿à¥¤",
        "ta": "à®®à®©à¯à®©à®¿à®•à¯à®•à®µà¯à®®à¯, à®‡à®ªà¯à®ªà¯‹à®¤à¯ à®‡à®£à¯ˆà®ªà¯à®ªà®¤à®¿à®²à¯ à®šà®¿à®•à¯à®•à®²à¯ à®‰à®³à¯à®³à®¤à¯. à®šà®¿à®±à®¿à®¤à¯ à®¨à¯‡à®°à®®à¯ à®•à®´à®¿à®¤à¯à®¤à¯ à®®à¯€à®£à¯à®Ÿà¯à®®à¯ à®®à¯à®¯à®±à¯à®šà®¿à®•à¯à®•à®µà¯à®®à¯.",
        "mr": "à¤•à¥à¤·à¤®à¤¸à¥à¤µ, à¤®à¤²à¤¾ à¤†à¤¤à¥à¤¤à¤¾ à¤•à¤¨à¥‡à¤•à¥à¤Ÿ à¤¹à¥‹à¤£à¥à¤¯à¤¾à¤¤ à¤¸à¤®à¤¸à¥à¤¯à¤¾ à¤¯à¥‡à¤¤ à¤†à¤¹à¥‡. à¤•à¥ƒà¤ªà¤¯à¤¾ à¤•à¤¾à¤¹à¥€ à¤µà¥‡à¤³à¤¾à¤¨à¥‡ à¤ªà¥à¤¨à¥à¤¹à¤¾ à¤ªà¥à¤°à¤¯à¤¤à¥à¤¨ à¤•à¤°à¤¾.",
        "kn": "à²•à³à²·à²®à²¿à²¸à²¿, à²¨à²¨à²—à³† à²ˆà²— à²¸à²‚à²ªà²°à³à²• à²¸à²¾à²§à²¿à²¸à³à²µà²²à³à²²à²¿ à²¤à³Šà²‚à²¦à²°à³† à²‡à²¦à³†. à²¦à²¯à²µà²¿à²Ÿà³à²Ÿà³ à²¸à³à²µà²²à³à²ª à²¸à²®à²¯à²¦ à²¨à²‚à²¤à²° à²®à²¤à³à²¤à³† à²ªà³à²°à²¯à²¤à³à²¨à²¿à²¸à²¿.",
        "bn": "à¦¦à§à¦ƒà¦–à¦¿à¦¤, à¦†à¦®à¦¾à¦° à¦à¦–à¦¨ à¦¸à¦‚à¦¯à§‹à¦—à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦šà§à¦›à§‡à¥¤ à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦•à¦¿à¦›à§à¦•à§à¦·à¦£ à¦ªà¦°à§‡ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨à¥¤",
        "gu": "àª®àª¾àª« àª•àª°àª¶à«‹, àª®àª¨à«‡ àª…àª¤à«àª¯àª¾àª°à«‡ àªœà«‹àª¡àª¾àªµàª¾àª®àª¾àª‚ àª®à«àª¶à«àª•à«‡àª²à«€ àª†àªµà«€ àª°àª¹à«€ àª›à«‡. àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª¥à«‹àª¡à«€àªµàª¾àª° àªªàª›à«€ àª«àª°à«€ àªªà«àª°àª¯àª¾àª¸ àª•àª°à«‹.",
    },
    "rate_limit": {
        "en": "You're sending messages too quickly. Please wait a moment and try again.",
        "hi": "à¤†à¤ª à¤¬à¤¹à¥à¤¤ à¤œà¤²à¥à¤¦à¥€ à¤¸à¤‚à¤¦à¥‡à¤¶ à¤­à¥‡à¤œ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤",
        "te": "à°®à±€à°°à± à°šà°¾à°²à°¾ à°¤à±à°µà°°à°—à°¾ à°¸à°‚à°¦à±‡à°¶à°¾à°²à± à°ªà°‚à°ªà±à°¤à±à°¨à±à°¨à°¾à°°à±. à°¦à°¯à°šà±‡à°¸à°¿ à°•à°¾à°¸à±‡à°ªà± à°µà±‡à°šà°¿ à°‰à°‚à°¡à°¿ à°®à°³à±à°²à±€ à°ªà±à°°à°¯à°¤à±à°¨à°¿à°‚à°šà°‚à°¡à°¿à¥¤",
        "ta": "à®¨à¯€à®™à¯à®•à®³à¯ à®®à®¿à®• à®µà®¿à®°à¯ˆà®µà®¾à®• à®šà¯†à®¯à¯à®¤à®¿à®•à®³à¯ˆ à®…à®©à¯à®ªà¯à®ªà¯à®•à®¿à®±à¯€à®°à¯à®•à®³à¯. à®šà®¿à®±à®¿à®¤à¯ à®¨à¯‡à®°à®®à¯ à®•à®¾à®¤à¯à®¤à®¿à®°à¯à®¨à¯à®¤à¯ à®®à¯€à®£à¯à®Ÿà¯à®®à¯ à®®à¯à®¯à®±à¯à®šà®¿à®•à¯à®•à®µà¯à®®à¯.",
        "mr": "à¤¤à¥à¤®à¥à¤¹à¥€ à¤–à¥‚à¤ª à¤µà¥‡à¤—à¤¾à¤¨à¥‡ à¤¸à¤‚à¤¦à¥‡à¤¶ à¤ªà¤¾à¤ à¤µà¤¤ à¤†à¤¹à¤¾à¤¤. à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¥à¤¾à¤‚à¤¬à¤¾ à¤†à¤£à¤¿ à¤ªà¥à¤¨à¥à¤¹à¤¾ à¤ªà¥à¤°à¤¯à¤¤à¥à¤¨ à¤•à¤°à¤¾.",
        "kn": "à²¨à³€à²µà³ à²¤à³à²‚à²¬à²¾ à²µà³‡à²—à²µà²¾à²—à²¿ à²¸à²‚à²¦à³‡à²¶à²—à²³à²¨à³à²¨à³ à²•à²³à³à²¹à²¿à²¸à³à²¤à³à²¤à²¿à²¦à³à²¦à³€à²°à²¿. à²¦à²¯à²µà²¿à²Ÿà³à²Ÿà³ à²•à²¾à²¯à²¿à²°à²¿ à²®à²¤à³à²¤à³ à²®à²¤à³à²¤à³† à²ªà³à²°à²¯à²¤à³à²¨à²¿à²¸à²¿.",
        "bn": "à¦†à¦ªà¦¨à¦¿ à¦–à§à¦¬ à¦¦à§à¦°à§à¦¤ à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦ªà¦¾à¦ à¦¾à¦šà§à¦›à§‡à¦¨à¥¤ à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦…à¦ªà§‡à¦•à§à¦·à¦¾ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨à¥¤",
        "gu": "àª¤àª®à«‡ àª–à«‚àª¬ àªàª¡àªªàª¥à«€ àª¸àª‚àª¦à«‡àª¶àª¾ àª®à«‹àª•àª²à«€ àª°àª¹à«àª¯àª¾ àª›à«‹. àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª°àª¾àª¹ àªœà«àª“ àª…àª¨à«‡ àª«àª°à«€ àªªà«àª°àª¯àª¾àª¸ àª•àª°à«‹.",
    },
    # Change language command
    "change_language_text": {
        "en": "ðŸŒ Change Language",
        "hi": "ðŸŒ à¤­à¤¾à¤·à¤¾ à¤¬à¤¦à¤²à¥‡à¤‚",
        "te": "ðŸŒ à°­à°¾à°· à°®à°¾à°°à±à°šà°‚à°¡à°¿",
        "ta": "ðŸŒ à®®à¯Šà®´à®¿à®¯à¯ˆ à®®à®¾à®±à¯à®±à®µà¯à®®à¯",
        "mr": "ðŸŒ à¤­à¤¾à¤·à¤¾ à¤¬à¤¦à¤²à¤¾",
        "kn": "ðŸŒ à²­à²¾à²·à³†à²¯à²¨à³à²¨à³ à²¬à²¦à²²à²¿à²¸à²¿",
        "bn": "ðŸŒ à¦­à¦¾à¦·à¦¾ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à§à¦¨",
        "gu": "ðŸŒ àª­àª¾àª·àª¾ àª¬àª¦àª²à«‹",
    },
}


def get_translation(key: str, language: str = DEFAULT_LANGUAGE) -> str:
    """
    Get translated text for a given key and language.
    Falls back to English if translation not found.
    """
    if key not in TRANSLATIONS:
        return key
    
    translations = TRANSLATIONS[key]
    return translations.get(language, translations.get(DEFAULT_LANGUAGE, key))


def detect_language(text: str) -> str:
    """
    Detect language from text using character ranges and common words.
    Returns language code (e.g., 'en', 'hi', 'te').
    """
    # Define character ranges for each language
    language_patterns = {
        "hi": r'[\u0900-\u097F]',      # Devanagari (Hindi, Marathi)
        "te": r'[\u0C00-\u0C7F]',      # Telugu
        "ta": r'[\u0B80-\u0BFF]',      # Tamil
        "kn": r'[\u0C80-\u0CFF]',      # Kannada
        "bn": r'[\u0980-\u09FF]',      # Bengali
        "gu": r'[\u0A80-\u0AFF]',      # Gujarati
        "mr": r'[\u0900-\u097F]',      # Marathi (shares Devanagari with Hindi)
    }
    
    # Check each language pattern
    for lang, pattern in language_patterns.items():
        if re.search(pattern, text):
            # For Devanagari (Hindi/Marathi), check for common words
            if lang == "hi":
                marathi_words = ["à¤†à¤¹à¥‡", "à¤†à¤¹à¥‡à¤¤", "à¤†à¤²à¤¾", "à¤¯à¥‡à¤¤", "à¤¹à¥‹à¤¤", "à¤•à¤¾à¤¹à¥€", "à¤•à¤¶à¥€", "à¤•à¤¸à¥‡"]
                if any(word in text for word in marathi_words):
                    return "mr"
                return "hi"
            return lang
    
    # Check for common language-specific words
    language_keywords = {
        "hi": ["à¤¹à¥ˆ", "à¤¹à¥ˆà¤‚", "à¤•à¥‡", "à¤•à¤¾", "à¤•à¥€", "à¤®à¥‡à¤‚", "à¤•à¥‹", "à¤¸à¥‡", "à¤ªà¤°", "à¤”à¤°"],
        "te": ["à°²à±‹", "à°•à±", "à°¨à±", "à°¤à±‹", "à°¯à±Šà°•à±à°•", "à°®à°°à°¿à°¯à±", "à°‰à°‚à°¦à°¿", "à°‰à°¨à±à°¨à°¾à°°à±"],
        "ta": ["à®‰à®³à¯à®³à®¤à¯", "à®‡à®°à¯à®•à¯à®•à®¿à®±à®¤à¯", "à®®à®±à¯à®±à¯à®®à¯", "à®Žà®©à¯à®±à¯", "à®‡à®²à¯à®²à¯ˆ"],
        "kn": ["à²‡à²¦à³†", "à²†à²—à²¿à²¦à³†", "à²®à²¤à³à²¤à³", "à²‡à²²à³à²²", "à²¹à²¾à²—à³‚"],
        "bn": ["à¦†à¦›à§‡", "à¦à¦¬à¦‚", "à¦¥à§‡à¦•à§‡", "à¦•à¦°à¦¾", "à¦¹à¦¯à¦¼"],
        "gu": ["àª›à«‡", "àª…àª¨à«‡", "àª¥à«€", "àª®àª¾àªŸà«‡", "àª¨àª¥à«€"],
        "mr": ["à¤†à¤¹à¥‡", "à¤†à¤£à¤¿", "à¤ªà¤¾à¤¸à¥‚à¤¨", "à¤¸à¤¾à¤ à¥€", "à¤¨à¤¾à¤¹à¥€"],
    }
    
    for lang, keywords in language_keywords.items():
        if any(keyword in text for keyword in keywords):
            return lang
    
    # Default to English
    return DEFAULT_LANGUAGE


def detect_language_change_request(text: str, current_language: str = DEFAULT_LANGUAGE) -> Optional[str]:
    """
    Detect if user is requesting to change language.
    Returns new language code if language change detected, None otherwise.
    """
    text_lower = text.lower().strip()
    
    # Language change keywords in different languages
    change_keywords = {
        "en": ["change language", "switch language", "language", "in hindi", "in telugu", 
               "in tamil", "in english", "speak hindi", "speak english", "speak telugu"],
        "hi": ["à¤­à¤¾à¤·à¤¾ à¤¬à¤¦à¤²à¥‹", "à¤­à¤¾à¤·à¤¾ à¤¬à¤¦à¤²à¥‡à¤‚", "à¤…à¤‚à¤—à¥à¤°à¥‡à¤œà¥€", "à¤¤à¥‡à¤²à¥à¤—à¥", "à¤¹à¤¿à¤‚à¤¦à¥€"],
        "te": ["à°­à°¾à°· à°®à°¾à°°à±à°šà°‚à°¡à°¿", "à°‡à°‚à°—à±à°²à±€à°·à±", "à°¹à°¿à°‚à°¦à±€", "à°¤à±†à°²à±à°—à±"],
        "ta": ["à®®à¯Šà®´à®¿ à®®à®¾à®±à¯à®±à¯", "à®†à®™à¯à®•à®¿à®²à®®à¯", "à®‡à®¨à¯à®¤à®¿", "à®¤à®®à®¿à®´à¯"],
    }
    
    # Check if any change keyword is present
    for lang_keywords in change_keywords.values():
        if any(keyword in text_lower for keyword in lang_keywords):
            # Try to detect which language they want
            if any(word in text_lower for word in ["english", "à¤…à¤‚à¤—à¥à¤°à¥‡à¤œà¥€", "à°‡à°‚à°—à±à°²à±€à°·à±", "à®†à®™à¯à®•à®¿à®²à®®à¯", "àª‡àª‚àª—à«àª²àª¿àª¶"]):
                return "en"
            elif any(word in text_lower for word in ["hindi", "à¤¹à¤¿à¤‚à¤¦à¥€", "à¤¹à¤¿à¤¨à¥à¤¦à¥€", "à°¹à°¿à°‚à°¦à±€", "à®‡à®¨à¯à®¤à®¿"]):
                return "hi"
            elif any(word in text_lower for word in ["telugu", "à°¤à±†à°²à±à°—à±", "à¦¤à§‡à¦²à§à¦—à§", "à°¤à±†à°²à±à°—à±à°²à±‹"]):
                return "te"
            elif any(word in text_lower for word in ["tamil", "à®¤à®®à®¿à®´à¯", "à¤¤à¤®à¤¿à¤²", "à°¤à°®à°¿à°³à±"]):
                return "ta"
            elif any(word in text_lower for word in ["kannada", "à²•à²¨à³à²¨à²¡", "à¤•à¤¨à¥à¤¨à¤¡à¤¼"]):
                return "kn"
            elif any(word in text_lower for word in ["marathi", "à¤®à¤°à¤¾à¤ à¥€", "à°®à°°à°¾à° à±€"]):
                return "mr"
            elif any(word in text_lower for word in ["bengali", "à¦¬à¦¾à¦‚à¦²à¦¾", "à¤¬à¤‚à¤—à¤¾à¤²à¥€"]):
                return "bn"
            elif any(word in text_lower for word in ["gujarati", "àª—à«àªœàª°àª¾àª¤à«€", "à¤—à¥à¤œà¤°à¤¾à¤¤à¥€"]):
                return "gu"
            # If no specific language mentioned, return None to show language selector
            return "show_selector"
    
    return None


def get_language_instruction(language: str) -> str:
    """
    Get instruction to add to system prompt for the specified language.
    """
    instructions = {
        "en": "Respond in English.",
        "hi": "à¤¹à¤¿à¤¨à¥à¤¦à¥€ à¤®à¥‡à¤‚ à¤‰à¤¤à¥à¤¤à¤° à¤¦à¥‡à¤‚à¥¤ Respond completely in Hindi language.",
        "te": "à°¤à±†à°²à±à°—à±à°²à±‹ à°¸à°®à°¾à°§à°¾à°¨à°‚ à°‡à°µà±à°µà°‚à°¡à°¿à¥¤ Respond completely in Telugu language.",
        "ta": "à®¤à®®à®¿à®´à®¿à®²à¯ à®ªà®¤à®¿à®²à®³à®¿à®•à¯à®•à®µà¯à®®à¯. Respond completely in Tamil language.",
        "mr": "à¤®à¤°à¤¾à¤ à¥€à¤¤ à¤‰à¤¤à¥à¤¤à¤° à¤¦à¥à¤¯à¤¾à¥¤ Respond completely in Marathi language.",
        "kn": "à²•à²¨à³à²¨à²¡à²¦à²²à³à²²à²¿ à²‰à²¤à³à²¤à²°à²¿à²¸à²¿à¥¤ Respond completely in Kannada language.",
        "bn": "à¦¬à¦¾à¦‚à¦²à¦¾à¦¯à¦¼ à¦‰à¦¤à§à¦¤à¦° à¦¦à¦¿à¦¨à¥¤ Respond completely in Bengali language.",
        "gu": "àª—à«àªœàª°àª¾àª¤à«€àª®àª¾àª‚ àªœàªµàª¾àª¬ àª†àªªà«‹à¥¤ Respond completely in Gujarati language.",
    }
    return instructions.get(language, instructions["en"])


def get_language_selector_message(current_language: str = DEFAULT_LANGUAGE) -> str:
    """
    Get the language selector message with options.
    """
    prompt = get_translation("language_selection_prompt", current_language)
    
    # Build language options
    options = []
    for code, info in SUPPORTED_LANGUAGES.items():
        options.append(f"{info['flag']} **{info['native']}** ({info['name']})")
    
    return f"{prompt}\n\n" + "\n".join(options)
